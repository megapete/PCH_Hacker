//
//  PCH_Exploit.h
//  PCH_Hacker
//
//  Created by PeterCoolAssHuber on 2018-09-07.
//  Copyright Â© 2018 Peter Huber. All rights reserved.
//

#ifndef PCH_Exploit_h
#define PCH_Exploit_h

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include "PCH_File.h"
#include "PCH_Url.h"

#define MAX_EXPLOIT_RETURN_STRING_SIZE 128

/// Give exploits their own type name
typedef PCH_File PCH_Exploit;

// struct used to pass info to the CreateExploit() executable function
typedef struct _exploitInputData {
    
    PCH_Url *url;
    int port;
    
} PCH_ExploitInputData;

typedef struct _exploitOutputData {
    
    char returnString[MAX_EXPLOIT_RETURN_STRING_SIZE];
    
} PCH_ExploitOutputData;

/// Convenience routine to create an exploit with the given name that can open the give port. The size number refers to the file size for display and memory purposes.
PCH_Exploit CreateExploit(char *name, int port, int size);

/// Function called to run the exploit on a given URL. If the URL has a port that corresponds to the port number defined in the exploit, the port is opened, the function fills returnBuff with a success message, and returns TRUE; otherwise it returns FALSE.
bool RunExploit(PCH_Exploit *exploit, PCH_Url *url, char *returnBuff, size_t returnBuffSize);

#endif /* PCH_Exploit_h */
